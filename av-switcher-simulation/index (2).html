<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SyncPoint - Full Kinetic MCR</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        :root {
            --obs-bg: #050505;
            --panel: #1a1a1c;
            --btn-idle: #333;
            --btn-pvw: #2ecc71;
            --btn-pgm: #e74c3c;
            --accent: #00ff41;
        }

        body { 
            background: var(--obs-bg); color: #fff; 
            font-family: 'Segoe UI', sans-serif; margin: 0; 
            display: flex; flex-direction: column; align-items: center; 
            justify-content: center; min-height: 100vh;
        }

        #system-header {
            width: 1280px; display: flex; justify-content: space-between;
            align-items: flex-end; margin-bottom: 10px; padding: 0 10px;
        }
        .brand { font-weight: 800; font-size: 24px; letter-spacing: -1px; color: #eee; }
        .brand span { color: var(--btn-pgm); }

        #canvas-wrapper { border: 4px solid #1a1a1a; background: #000; line-height: 0; }

        #switcher {
            margin-top: 20px; width: 1280px; background: var(--panel);
            border-radius: 8px; border: 1px solid #444;
            padding: 20px; display: grid; grid-template-columns: 2fr 1fr 1.5fr; gap: 30px;
            box-sizing: border-box;
        }

        .switcher-section { display: flex; flex-direction: column; gap: 15px; }
        .section-label { font-size: 10px; color: #777; font-weight: bold; letter-spacing: 1px; }

        .button-row { display: flex; gap: 15px; }
        .atem-btn {
            width: 50px; height: 50px; border-radius: 50%; border: 3px solid #111;
            background: var(--btn-idle); cursor: pointer; box-shadow: 0 4px 0 #000;
        }
        .atem-btn.pgm-active { background: var(--btn-pgm); box-shadow: 0 0 15px rgba(231, 76, 60, 0.6); }
        .atem-btn.pvw-active { background: var(--btn-pvw); box-shadow: 0 0 15px rgba(46, 204, 113, 0.6); }

        .rect-btn { width: 80px; height: 50px; background: #444; border: 1px solid #555; color: white; cursor: pointer; font-weight: bold;}

        #clocks { margin-top: 15px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; width: 1280px; }
        .clock-card { background: #111; padding: 10px; border: 1px solid #222; text-align: center; }
        .time { color: var(--accent); font-family: monospace; font-size: 18px; }
    </style>
</head>
<body>

<div id="system-header">
    <div class="brand">Sync<span>Point</span> MultiViewer</div>
    <div style="font-family:monospace; font-size:10px; color:#666;">KINETIC_ENGINE: ON</div>
</div>

<div id="canvas-wrapper"><div id="p5-holder"></div></div>

<div id="switcher">
    <div class="switcher-section">
        <div class="section-label">INPUT BUS</div>
        <div class="button-row">
            <button class="atem-btn pgm-active" id="btn-1" onclick="switchInput(1)"></button>
            <button class="atem-btn" id="btn-2" onclick="switchInput(2)"></button>
            <button class="atem-btn" id="btn-3" onclick="switchInput(3)"></button>
            <button class="atem-btn pvw-active" id="btn-4" onclick="switchInput(4)"></button>
        </div>
    </div>

    <div class="switcher-section">
        <div class="section-label">TRANSITION</div>
        <div style="display: flex; gap: 10px;">
            <button class="rect-btn" onclick="takeCut()">CUT</button>
            <button class="rect-btn" style="background:#666" onclick="takeCut()">AUTO</button>
        </div>
    </div>

    <div class="switcher-section">
        <div class="section-label">SIGNAL DATA</div>
        <div id="log-box" style="background:#000; padding:10px; border:1px solid #333; font-family:monospace; font-size:10px; color:var(--accent); height: 40px;">
            > ALL SIGNALS KINETIC<br>> NO STATIC DATA DETECTED
        </div>
    </div>
</div>

<div id="clocks">
    <div class="clock-card"><div class="time" id="t1">00:00:00</div><div style="font-size:9px">NEW YORK</div></div>
    <div class="clock-card"><div class="time" id="t2">00:00:00</div><div style="font-size:9px">LONDON</div></div>
    <div class="clock-card"><div class="time" id="t3">00:00:00</div><div style="font-size:9px">TOKYO</div></div>
    <div class="clock-card"><div class="time" id="t4">00:00:00</div><div style="font-size:9px">SYDNEY</div></div>
</div>

<script>
    let pgmSource = 1, pvwSource = 4;
    let channels = [], timeStrings = ["", "", "", ""];
    const labels = ["NEW YORK", "LONDON", "TOKYO", "SYDNEY"];

    function setup() {
        let cnv = createCanvas(1280, 720);
        cnv.parent('p5-holder');
        for(let i=0; i<4; i++) channels[i] = createGraphics(640, 360);
    }

    function draw() {
        background(0);
        updateClocks();
        
        // Update 4 Unique Dynamic Buffers
        for(let i=0; i<4; i++) {
            let pg = channels[i];
            pg.background(10, 10, 25);
            pg.push();
            pg.translate(320, 180);
            
            if(i==0) { // CH 1: Expanding Pulse
                pg.noFill(); pg.stroke(0, 255, 255); pg.strokeWeight(3);
                for(let r=0; r<400; r+=80) {
                    let size = (r + frameCount*3) % 400;
                    pg.ellipse(0, 0, size, size);
                }
            } 
            else if(i==1) { // CH 2: Flowing Waveform (Now fully dynamic)
                pg.stroke(255, 255, 0); pg.strokeWeight(2);
                for(let x=-320; x<320; x+=10) {
                    let y = sin(x*0.02 + frameCount*0.1) * 100;
                    let y2 = sin((x+10)*0.02 + frameCount*0.1) * 100;
                    pg.line(x, y, x+10, y2);
                    pg.line(x, y, x, 180); // Moving bars
                }
            }
            else if(i==2) { // CH 3: Orbiting Vectors (Replaced static grid)
                pg.stroke(0, 255, 0); pg.noFill();
                pg.rotate(frameCount * 0.05);
                for(let a=0; a<TWO_PI; a+=PI/4) {
                    pg.push();
                    pg.rotate(a);
                    pg.rect(60 + sin(frameCount*0.1)*20, 0, 40, 40);
                    pg.pop();
                }
            }
            else if(i==3) { // CH 4: Liquid Helix
                pg.noStroke(); pg.fill(200, 100, 255);
                for(let j=0; j<20; j++) {
                    let x = sin(frameCount*0.05 + j*0.5) * 150;
                    let y = -180 + (j*20 + frameCount*2) % 360;
                    pg.ellipse(x, y, 15, 15);
                }
            }
            pg.pop();

            // BURN-IN (Locks to Buffer)
            pg.noStroke(); pg.fill(0, 220); pg.rect(20, 20, 180, 60, 5);
            pg.fill(0, 255, 65); pg.textSize(14); pg.text(labels[i], 35, 42);
            pg.textSize(24); pg.text(timeStrings[i], 35, 68);
        }

        // Layout Render
        let qw = 480, qh = 270; // 16:9 quadrants
        drawFrame(0, 0, qw, qh, "IN 01", "#ffcc00", channels[0]);
        drawFrame(qw, 0, qw, qh, "IN 02", "#ffcc00", channels[1]);
        drawFrame(0, qh, qw, qh, "IN 03", "#ffcc00", channels[2]);
        drawFrame(qw, qh, qw, qh, "IN 04", "#ffcc00", channels[3]);

        // Master Stack (16:9)
        drawFrame(960, 0, 320, 180, "PROGRAM", "#ff0000", channels[pgmSource-1]);
        drawFrame(960, 180, 320, 180, "PREVIEW", "#00ff00", channels[pvwSource-1]);
        
        // Telemetry Block
        fill(20); noStroke(); rect(960, 360, 320, 180);
        fill(60); textAlign(CENTER); textSize(12);
        text("SYNCPOINT KINETIC ENGINE\nREF: 60FPS / 16:9", 960+160, 450);
    }

    function drawFrame(x, y, w, h, lbl, tally, buf) {
        push(); translate(x, y);
        image(buf, 4, 4, w-8, h-8);
        stroke(tally); strokeWeight(4); noFill(); rect(2, 2, w-4, h-4);
        noStroke(); fill(0, 180); rect(4, h-22, w-8, 18);
        fill(255); textSize(10); text("  " + lbl, 10, h-9);
        pop();
    }

    function switchInput(n) {
        pvwSource = n;
        document.querySelectorAll('.atem-btn').forEach(b => b.classList.remove('pvw-active'));
        document.getElementById('btn-'+n).classList.add('pvw-active');
    }

    function takeCut() {
        pgmSource = pvwSource;
        document.querySelectorAll('.atem-btn').forEach(b => b.classList.remove('pgm-active'));
        document.getElementById('btn-'+pgmSource).classList.add('pgm-active');
    }

    function updateClocks() {
        let d = new Date(), utc = d.getTime() + (d.getTimezoneOffset() * 60000);
        const offsets = [-5, 0, 9, 11];
        offsets.forEach((o, i) => {
            let nd = new Date(utc + (3600000 * o));
            timeStrings[i] = nf(nd.getHours(),2)+":"+nf(nd.getMinutes(),2)+":"+nf(nd.getSeconds(),2);
            document.getElementById('t'+(i+1)).innerText = timeStrings[i];
        });
    }
    setInterval(updateClocks, 1000);
</script>
</body>
</html>